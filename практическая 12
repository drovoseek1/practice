#include <iostream>
#include <string>
#include <limits> 
#include <vector> 

using namespace std;


struct Question {
    string text;         
    vector<string> options; 
    char correctAnswer;  
};


struct GameSettings {
    string userName;
    int startingLives = 3;
   
};

int main() {
    
#ifdef _WIN32
    system("chcp 1251");
#endif

    
    int mainMenuChoice = 0;
    bool exitProgram = false;

    GameSettings settings; 
    settings.userName = "Игрок"; 

   
    vector<Question> questions = {
        {"Вопрос: Системный язык программирования?",
         {"A) Python", "B) C#", "C) Ruby", "D) C++"},
         'D'}, // Правильный ответ C++
        {"Вопрос: Какой язык используется для веб-разработки?",
         {"A) Java", "B) JavaScript", "C) Swift", "D) Go"},
         'B'}, // Правильный ответ JavaScript
        {"Вопрос: Какой тип данных используется для хранения целых чисел?",
         {"A) float", "B) double", "C) int", "D) string"},
         'C'}, // Правильный ответ int
        {"Вопрос: Оператор для вывода данных в консоль в C++?",
         {"A) cin", "B) cout", "C) cerr", "D) clog"},
         'B'}, // Правильный ответ cout
        {"Вопрос: Для чего используется цикл 'while'?",
         {"A) Для выполнения блока кода фиксированное количество раз",
          "B) Для выполнения блока кода, пока условие истинно",
          "C) Для перехода к другому блоку кода",
          "D) Для выполнения блока кода один раз"},
         'B'}, // Правильный ответ
        {"Вопрос: Какой оператор проверяет условие и выполняет код, если оно истинно?",
         {"A) else", "B) for", "C) if", "D) while"},
         'C'}  // Правильный ответ if
    };

    // --- Начало программы: Приветствие ---
    cout << "----------------------------------------" << endl;
    cout << "    Добро пожаловать в Викторину!    " << endl;
    cout << "----------------------------------------" << endl;

    // --- Главное меню ---
    while (!exitProgram) {
        cout << "\n--- Главное меню ---" << endl;
        cout << "1 - Начать игру" << endl;
        cout << "2 - Настройки" << endl;
        cout << "3 - Правила" << endl;
        cout << "4 - Выйти" << endl;
        cout << "--------------------" << endl;
        cout << "[+] Ваш выбор: ";

        cin >> mainMenuChoice;

        // Проверка на некорректный ввод (не число)
        if (cin.fail()) {
            cout << "[+] Ошибка: Некорректный ввод. Введите число." << endl;
            cin.clear();
            cin.ignore(numeric_limits<streamsize>::max(), '\n');
            continue; // Переходим к следующей итерации цикла
        }

        // Обработка выбора главного меню
        if (mainMenuChoice == 1) {
            // --- Начало игры ---
            cout << "\n--- Начинаем игру ---" << endl;
            int lives = settings.startingLives;
            int score = 0;
            int currentQuestionIndex = 0; // Индекс текущего вопроса

            // Цикл игры, пока жизни не кончились и есть вопросы
            while (lives > 0 && currentQuestionIndex < questions.size()) {
                const Question& currentQuestion = questions[currentQuestionIndex]; // Берем текущий вопрос

                cout << "\n" << currentQuestion.text << endl;
                for (const string& option : currentQuestion.options) {
                    cout << option << endl;
                }

                char userAnswer;
                cout << "[+] Ваш ответ (A, B, C, D): ";
                cin >> userAnswer;

                // Проверка на некорректный ввод дня месяца (если это был бы день)
                if (cin.fail()) {
                    cout << "[+] Ошибка: Некорректный ввод. Введите букву." << endl;
                    cin.clear();
                    cin.ignore(numeric_limits<streamsize>::max(), '\n');
                    // Пропускаем вопрос, но жизни не теряем (можно изменить логику)
                    continue;
                }

                // Сравниваем введенный ответ с правильным (приводим к верхнему регистру для удобства)
                if (toupper(userAnswer) == currentQuestion.correctAnswer) {
                    cout << "[+] Правильный ответ! Вы получаете очки." << endl;
                    score++; // Начисляем очки
                    // Здесь можно было бы добавить прогресс по вопросам
                    currentQuestionIndex++; // Переходим к следующему вопросу
                }
                else {
                    cout << "[+] Неправильный ответ." << endl;
                    lives--; // Теряем жизнь
                    cout << "[!] У вас осталось жизней: " << lives << endl;

                    // Если жизни кончились, выходим из цикла игры
                    if (lives <= 0) {
                        break;
                    }
                    // Сгенерировать новый вопрос (или переставить текущий)
                    // Для простоты, просто переходим к следующему вопросу, если жизни остались
                    currentQuestionIndex++;
                }
            }

            // --- Конец игры ---
            cout << "\n--- Результаты игры ---" << endl;
            if (lives <= 0) {
                cout << "[!] Потеряв все жизни, вы проиграли!" << endl;
            }
            else {
                cout << "[+] Поздравляем! Вы успешно ответили на " << score << " вопросов." << endl;
            }
            cout << "[+] Осталось жизней: " << lives << endl;
            cout << "-----------------------" << endl;

        }
        else if (mainMenuChoice == 2) {
            // --- Настройки ---
            cout << "\n--- Настройки ---" << endl;
            string newName;
            cout << "Текущее имя игрока: " << settings.userName << endl;
            cout << "Введите новое имя игрока (или нажмите Enter, чтобы оставить прежнее): ";
            cin.ignore(numeric_limits<streamsize>::max(), '\n'); // Очищаем буфер перед getline
            getline(cin, newName); // Читаем строку, включая пробелы

            if (!newName.empty()) { // Если пользователь ввел что-то
                settings.userName = newName;
                cout << "[+] Имя игрока изменено на \"" << settings.userName << "\"." << endl;
            }

            // Редактирование вопросов (только для демонстрации, реальное редактирование сложно)
            // Тут можно было бы добавить интерфейс для изменения вопросов, но это значительно усложнит код
            cout << "[!] Редактирование вопросов и цветов интерфейса не реализовано в этой версии." << endl;

            cout << "-----------------" << endl;

        }
        else if (mainMenuChoice == 3) {
            // --- Правила ---
            cout << "\n--- Правила игры ---" << endl;
            cout << "[+] Игра \"Викторина\"" << endl;
            cout << "\"-\" - игрок получает очки за правильный ответ на вопрос;" << endl;
            cout << "\"-\" - игрок проходит дальше за правильный ответ;" << endl;
            cout << "\"-\" - игрок теряет жизнь при неправильном ответе." << endl;
            cout << endl;

            int rulesMenuChoice;
            cout << "Куда пойти: " << endl;
            cout << "1 - В главное меню" << endl;
            cout << "2 - Назад (выход из меню правил)" << endl; // Обозначим выход более нейтрально
            cout << "[+] Ваш выбор: ";
            cin >> rulesMenuChoice;

            // Проверка на некорректный ввод
            if (cin.fail()) {
                cout << "[+] Ошибка: Некорректный ввод. Введите число." << endl;
                cin.clear();
                cin.ignore(numeric_limits<streamsize>::max(), '\n');
                continue; // Возвращаемся в главное меню
            }

            // Обработка выбора в меню правил
            if (rulesMenuChoice == 1) {
                cout << "[+] Возвращаемся в главное меню..." << endl;
                // Ничего не делаем, цикл while в main() автоматически вернет нас в начало
            }
            else if (rulesMenuChoice == 2) {
                cout << "[+] Выход из меню правил." << endl;
                // Просто выходим из этого блока if, цикл while продолжится
            }
            else {
                cout << "[+] Некорректный выбор." << endl;
            }
            cout << "--------------------" << endl;

        }
        else if (mainMenuChoice == 4) {
            // --- Выход ---
            cout << "[+] Спасибо за игру! До свидания!" << endl;
            exitProgram = true; // Устанавливаем флаг для выхода из программы
        }
        else { // Некорректный выбор в главном меню
            cout << "[+] Некорректный выбор. Попробуйте снова." << endl;
        }
    } // Конец

    return 0;
}
